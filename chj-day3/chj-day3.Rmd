---
title: "Tutorial"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(tidyverse)
library(learnr)
library(fs)
knitr::opts_chunk$set(echo = FALSE)
```


## Our goals for the day

- Bind (stack) data on top of each other
- Join data next to each other
- Reshape data
- Visualize with ggplot

## Binding rows (stacking data)

```{r prep-names}
yob2017 <- read_csv(
  "https://raw.githubusercontent.com/utdata/chj-r-introduction/main/data/yob2017.txt",
  col_types = cols(sex = col_character()
  )
)

yob2018 <- read_csv(
  "https://raw.githubusercontent.com/utdata/chj-r-introduction/main/data/yob2018.txt",
  col_types = cols(sex = col_character()
  )
)

yob2019 <- read_csv(
  "https://raw.githubusercontent.com/utdata/chj-r-introduction/main/data/yob2019.txt",
  col_types = cols(sex = col_character()
  )
)
```

For this lesson, we assume that multiple data frames have already been imported. There are three data sets of baby names that are exactly the same, one from each year.

We'll peek at the 2017 data here:

```{r bind-01, exercise=T, exercise.setup="prep-names"}
# Available data frames: yob2017, yob2019, yob2019

# peek at yob2017. All dfs have same col names.
yob2017 %>% head()

# length of yob2017
yob2017 %>% nrow()

```

This is the [bind]() step, using `bind_rows()` since we are stacking data on top of each other. All three data frames have the same column names, so they will stack right on top of each other. We'll show the difference by printing the number of rows `nrow()` of the combined data.

```{r bind-02, exercise=T, exercise.setup="prep-names", exercise.lines=16}
# bind the rows together
names <- bind_rows(
  "2017" = yob2017,
  "2018" = yob2018,
  "2019" = yob2019,
  .id="yr"
)

# peek at the top of the data frame
names %>% head(3)

# peek at the bottom of the data frame
names %>% tail(3)

# get the length of the combined data frame
names %>% nrow()
```

Let's break that down a little.

- Within the `bind_rows()` function, we give each data frame an named value, `"2017" = yob2017`.
- In the last line, we set the `.id` to use that named value as a column called `yr`.

If we didn't include the names and id, then we would just stack the data and not know where it came from.

## Joining data frames

The tidyverse uses SQL-like logic to join data frames. In the interest of time, I'm going to gloss over all the different types of joins and instead point you to a chapter in [R for Data Science](https://r4ds.had.co.nz/relational-data.html#understanding-joins) which you can read later.

For our example, we are going to join a data frame of recent COVID-19 case and death counts with some population data so we can calculate cases per 100,000 for Texas counties. The data has been pre-worked for this lesson and made available to the lesson as




## Reshaping data

- Reshaping data with tidyr.

## Visualization with ggplot

- Introduction to ggplot.

## Examples

### Exercise 

*Here's a simple exercise with an empty code chunk provided for entering the answer.*

Write the R code required to add two plus two:

```{r two-plus-two, exercise=TRUE}

```

### Exercise with Code

*Here's an exercise with some prepopulated code as well as `exercise.lines = 5` to provide a bit more initial room to work.*

Now write a function that adds any two numbers and then call it:

```{r add-function, exercise=TRUE, exercise.lines = 5}
add <- function() {
  
}
```

## Topic 2

### Exercise with Hint

*Here's an exercise where the chunk is pre-evaulated via the `exercise.eval` option (so the user can see the default output we'd like them to customize). We also add a "hint" to the correct solution via the chunk immediate below labeled `print-limit-hint`.*

Modify the following code to limit the number of rows printed to 5:

```{r print-limit, exercise=TRUE, exercise.eval=TRUE}
mtcars
```

```{r print-limit-hint}
head(mtcars)
```

### Quiz

*You can include any number of single or multiple choice questions as a quiz. Use the `question` function to define a question and the `quiz` function for grouping multiple questions together.*

Some questions to verify that you understand the purposes of various base and recommended R packages:

```{r quiz}
quiz(
  question("Which package contains functions for installing other R packages?",
    answer("base"),
    answer("tools"),
    answer("utils", correct = TRUE),
    answer("codetools")
  ),
  question("Which of the R packages listed below are used to create plots?",
    answer("lattice", correct = TRUE),
    answer("tools"),
    answer("stats"),
    answer("grid", correct = TRUE)
  )
)
```

